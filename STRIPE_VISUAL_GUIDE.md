# ğŸ¨ Stripe Integration - Visual Guide

## 1ï¸âƒ£ Subscribe Page

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸµ Song Recommender                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚         Choose Your Plan                           â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  Monthly Plan    â”‚  â”‚  Yearly Plan     â”‚       â”‚
â”‚  â”‚                  â”‚  â”‚  Save 58%! â­    â”‚       â”‚
â”‚  â”‚      $20         â”‚  â”‚      $100        â”‚       â”‚
â”‚  â”‚   per month      â”‚  â”‚    per year      â”‚       â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚       â”‚
â”‚  â”‚ âœ“ Unlimited      â”‚  â”‚ âœ“ Unlimited      â”‚       â”‚
â”‚  â”‚ âœ“ Searches       â”‚  â”‚ âœ“ Searches       â”‚       â”‚
â”‚  â”‚ âœ“ Sentiment      â”‚  â”‚ âœ“ Sentiment      â”‚       â”‚
â”‚  â”‚ âœ“ Cancel Anytime â”‚  â”‚ âœ“ Best Value     â”‚       â”‚
â”‚  â”‚                  â”‚  â”‚                  â”‚       â”‚
â”‚  â”‚ [Subscribe]      â”‚  â”‚ [Subscribe]      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 2ï¸âƒ£ Checkout Page

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸµ Song Recommender                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚              Checkout                              â”‚
â”‚                                                     â”‚
â”‚  Plan:              Monthly                        â”‚
â”‚  Amount:            $20                            â”‚
â”‚  Order ID:          abc-123-def                    â”‚
â”‚                                                     â”‚
â”‚  â„¹ï¸  You will be redirected to Stripe to          â”‚
â”‚     complete your payment securely.               â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ğŸ”’ Proceed to Payment                   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Cancel                                  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                     â”‚
â”‚  ğŸ›¡ï¸ Secure payment powered by Stripe              â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 3ï¸âƒ£ Stripe Checkout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Stripe Checkout                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚  Order Summary                                      â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚  Monthly Subscription              $20.00          â”‚
â”‚                                                     â”‚
â”‚  Payment Method                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Card Number                             â”‚      â”‚
â”‚  â”‚ [4242 4242 4242 4242]                   â”‚      â”‚
â”‚  â”‚                                         â”‚      â”‚
â”‚  â”‚ Expiry Date    CVC                      â”‚      â”‚
â”‚  â”‚ [12/25]        [123]                    â”‚      â”‚
â”‚  â”‚                                         â”‚      â”‚
â”‚  â”‚ Name on Card                            â”‚      â”‚
â”‚  â”‚ [John Doe]                              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ Pay $20.00                              â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 4ï¸âƒ£ Payment Flow

```
START
  â”‚
  â”œâ”€â†’ User clicks "Subscribe"
  â”‚
  â”œâ”€â†’ Django creates Purchase & Subscription (inactive)
  â”‚
  â”œâ”€â†’ StripeAPI.create_checkout_session()
  â”‚
  â”œâ”€â†’ Redirect to Stripe checkout
  â”‚
  â”œâ”€â†’ User enters card details
  â”‚
  â”œâ”€â†’ User clicks "Pay"
  â”‚
  â”œâ”€â†’ Stripe processes payment
  â”‚
  â”œâ”€â†’ Payment successful?
  â”‚   â”‚
  â”‚   â”œâ”€â†’ YES: Stripe sends webhook
  â”‚   â”‚        â”‚
  â”‚   â”‚        â”œâ”€â†’ Django receives webhook
  â”‚   â”‚        â”‚
  â”‚   â”‚        â”œâ”€â†’ Verify signature
  â”‚   â”‚        â”‚
  â”‚   â”‚        â”œâ”€â†’ Subscription.activate()
  â”‚   â”‚        â”‚
  â”‚   â”‚        â”œâ”€â†’ Set subscription dates
  â”‚   â”‚        â”‚
  â”‚   â”‚        â””â”€â†’ âœ… User gets unlimited access!
  â”‚   â”‚
  â”‚   â””â”€â†’ NO: Payment failed
  â”‚        â”‚
  â”‚        â””â”€â†’ User notified
  â”‚
END
```

## 5ï¸âƒ£ Database Records

### After Successful Payment

```
Purchase Table:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID â”‚ User    â”‚ Plan    â”‚ Amount â”‚ Status    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ john    â”‚ monthly â”‚ $20    â”‚ completed â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Subscription Table:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ID â”‚ User â”‚ Plan    â”‚ Active â”‚ Start Date â”‚ End Date â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ 1  â”‚ john â”‚ monthly â”‚ True   â”‚ 2025-10-29 â”‚ 2025-11-28â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 6ï¸âƒ£ Setup Steps

```
Step 1: Get Stripe Keys
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Go to dashboard.stripe.com           â”‚
â”‚ 2. Sign up or sign in                   â”‚
â”‚ 3. Click Developers â†’ API Keys          â”‚
â”‚ 4. Copy Publishable Key (pk_test_...)   â”‚
â”‚ 5. Copy Secret Key (sk_test_...)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
Step 2: Update .env File
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ STRIPE_PUBLISHABLE_KEY=pk_test_...      â”‚
â”‚ STRIPE_SECRET_KEY=sk_test_...           â”‚
â”‚ STRIPE_WEBHOOK_SECRET=whsec_...         â”‚
â”‚ SITE_URL=http://127.0.0.1:8000          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
Step 3: Set Up Webhook
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Stripe Dashboard â†’ Webhooks          â”‚
â”‚ 2. Add endpoint                         â”‚
â”‚ 3. URL: http://127.0.0.1:8000/webhook/ â”‚
â”‚ 4. Select events                        â”‚
â”‚ 5. Copy Signing Secret                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
Step 4: Test
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Go to /subscribe/                    â”‚
â”‚ 2. Click Subscribe                      â”‚
â”‚ 3. Use test card: 4242 4242 4242 4242   â”‚
â”‚ 4. Complete payment                     â”‚
â”‚ 5. âœ… Done!                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## 7ï¸âƒ£ File Structure

```
song_recommender/
â”œâ”€â”€ recommender/
â”‚   â”œâ”€â”€ views.py
â”‚   â”‚   â”œâ”€â”€ checkout()           â† Handles checkout
â”‚   â”‚   â””â”€â”€ stripe_webhook()     â† Handles webhook
â”‚   â”‚
â”‚   â”œâ”€â”€ utils.py
â”‚   â”‚   â””â”€â”€ StripeAPI class      â† Stripe operations
â”‚   â”‚       â”œâ”€â”€ create_checkout_session()
â”‚   â”‚       â”œâ”€â”€ verify_webhook_signature()
â”‚   â”‚       â””â”€â”€ get_payment_status()
â”‚   â”‚
â”‚   â”œâ”€â”€ models.py
â”‚   â”‚   â”œâ”€â”€ Purchase             â† Payment tracking
â”‚   â”‚   â””â”€â”€ Subscription         â† Subscription tracking
â”‚   â”‚
â”‚   â”œâ”€â”€ urls.py
â”‚   â”‚   â””â”€â”€ /webhook/stripe/     â† Webhook endpoint
â”‚   â”‚
â”‚   â””â”€â”€ templates/
â”‚       â”œâ”€â”€ subscribe.html       â† Plans page
â”‚       â””â”€â”€ checkout.html        â† Checkout page
â”‚
â”œâ”€â”€ song_recommender/
â”‚   â””â”€â”€ settings.py
â”‚       â”œâ”€â”€ SITE_URL
â”‚       â”œâ”€â”€ STRIPE_PUBLISHABLE_KEY
â”‚       â”œâ”€â”€ STRIPE_SECRET_KEY
â”‚       â””â”€â”€ STRIPE_WEBHOOK_SECRET
â”‚
â””â”€â”€ .env                         â† Your keys go here!
```

## 8ï¸âƒ£ Status Indicators

```
âœ… Backend Code:        COMPLETE
âœ… Frontend Templates:  COMPLETE
âœ… Database Models:     COMPLETE
âœ… URL Routes:          COMPLETE
âœ… Settings:            COMPLETE
âœ… Stripe Package:      INSTALLED
âœ… Django Checks:       PASSED

ğŸ”§ Your Action Needed:
   1. Get Stripe keys
   2. Update .env
   3. Set up webhook
   4. Test payment
```

## 9ï¸âƒ£ Test Card Details

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Test Card Information                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Card Number:  4242 4242 4242 4242       â”‚
â”‚ Expiry Date:  Any future date (12/25)   â”‚
â”‚ CVC:          Any 3 digits (123)        â”‚
â”‚ Name:         Any name                  â”‚
â”‚ Zip:          Any zip code              â”‚
â”‚                                         â”‚
â”‚ Result: âœ… Payment succeeds             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”Ÿ Success Checklist

```
After Setup:
â˜ Can access /subscribe/ page
â˜ Can click subscribe buttons
â˜ Redirected to Stripe checkout
â˜ Can enter test card details
â˜ Payment completes successfully
â˜ Redirected back to app
â˜ Subscription is active in database
â˜ User has unlimited access
â˜ No errors in Django logs

âœ… All checked? You're done! ğŸ‰
```

---

## Quick Reference

| Item | Value |
|------|-------|
| Subscribe URL | http://127.0.0.1:8000/subscribe/ |
| Webhook URL | http://127.0.0.1:8000/webhook/stripe/ |
| Test Card | 4242 4242 4242 4242 |
| Monthly Price | $20 |
| Yearly Price | $100 |
| Free Limit | 10 searches/day |
| Setup Time | ~10 minutes |

---

**You're ready to go! ğŸš€**

